<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title>首页</title>
		<link rel="stylesheet" href="../../css/base.css" />
		<link rel="stylesheet" href="../../css/iconfont.css" />
		<link rel="stylesheet" href="../../css/layout.css" />
		<link rel="stylesheet" href="css/home.css" />
		<script src="../../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../js/ajaxs.js" type="text/javascript" charset="utf-8"></script>
	</head>
<style>
	
</style>
	<body>
		<header class="heads">
			<div>
				<input type="text" />
			</div>
			<div>推荐</div>
		</header>
		<section class="sets">
			<div>
				<div class="videos">
					<img src="../../img/home_01.png" alt="" />
					<div>
						<div>
							<div>
								<img src="../../img/home_03.png" alt="" />
							</div>
							<div>小芳</div>
						</div>
						<div>关注</div>
					</div>
					<div>
						<div class="iconfont icon-pinglun1">
							<span>11</span>
						</div>
						<div class="iconfont icon-z-likeFill">
							<span>22</span>
						</div>
						<div class="iconfont icon-star">
							<span>33</span>
						</div>
						<div class="iconfont icon-zhibo-">
							<span>44</span>
						</div>
					</div>
				</div>
			</div>
		</section>
		<footer class="footersd">
			<a href="./home.html" id="home" class="iconfont icon-shouye">
				<span>首页</span>
			</a>
			<a href="./videos.html" id="videos" class="iconfont icon-shipin">
				<span>小视频</span>
			</a>
			<div id="upvideo">
				<img src="../../img/home_04.png" alt="" />
			</div>
			<a href="./message.html" id="message" class="iconfont icon-xiaoxi">
				<span>消息</span>
			</a>
			<a href="./my.html" id="my" class="iconfont icon-ziyuan">
				<span>我的</span>
			</a>
		</footer>

<script type="text/javascript">
	$(function(){
		var _token = JSON.parse(localStorage.getItem('TT_TOKEN'));
//获取个人信息
		ajaxsd("user/token/"+_token+"?token="+_token,'post',{},function(data){
			console.log(data);
			if(data.status==321){
				window.location.href="../login/login.html";
			}
			var personal={
				token:_token,
				user:data.data
			}
			localStorage.setItem('user', JSON.stringify(personal));
//首页推荐
			var parameter={
				token:_token,
				page:1,
				size:5,
				userId:data.data.userid
			}
			ajaxsd("homepage/video/recommended",'post',parameter,function(data){
				console.log(data);
				if(data.status==321){
					window.location.href="../login/login.html";
				}
				if(data.status==200){
					var homes="";
					var videos=data.data;
					for(i in videos){
						if(videos[i].userInfo.视频发布者的昵称==null){
							videos[i].userInfo.视频发布者的昵称="小明小明小明";
						}
						if(videos[i].pinglun==undefined){
							videos[i].pinglun=0;
						}
						if(videos[i].guankan==undefined){
							videos[i].guankan=0;
						}
						homes+=`<div class="videos" data-ids=${videos[i].video.userid} data-vids=${videos[i].video.videoId}>
									<img src=${videos[i].video.picture} alt="" />
									<div>
										<div>
											<div>
												<img src=${videos[i].userInfo.视频发布者的头像} alt="" />
											</div>
											<div>${videos[i].userInfo.视频发布者的昵称}</div>
										</div>
										<div>关注</div>
									</div>
									<div>
										<div class="iconfont icon-pinglun1">
											<span>${videos[i].pinglun}</span>
										</div>
										<div class="iconfont icon-z-likeFill" data-dianz=${videos[i].love.是否点赞}>
											<span>${videos[i].love.点赞总数}</span>
										</div>
										<div class="iconfont icon-star" data-scs=${videos[i].collections.是否收藏}>
											<span>${videos[i].collections.收藏总数}</span>
										</div>
										<div class="iconfont icon-zhibo-">
											<span>${videos[i].guankan}</span>
										</div>
									</div>
								</div>`;
					}
					$(".sets>div").html(homes);
//点击播放当前视频
					$(".sets").on("click",".videos",function(){
						console.log($(this).index());
						var ids=$(this).data("ids");
						console.log(ids);
					})
					
				}else if(data.status==321){
					window.location.href="../login/login.html";
				}
			},function(err){
				console.log(err);
			})
			/*$.ajax({
				type:"get",
				url:"./json/home.json",
				dataType : "json",
				success: function(data) {
					var videos=data.videos;
					var homes="";
					for(i in videos){
						homes+=`<div class="videos" data-ids=${videos[i].id}>
									<img src=${videos[i].v01} alt="" />
									<div>
										<div>
											<div>
												<img src=${videos[i].imgages} alt="" />
											</div>
											<div>${videos[i].name}</div>
										</div>
										<div>关注</div>
									</div>
									<div>
										<div class="iconfont icon-pinglun1">
											<span>${videos[i].pinglun}</span>
										</div>
										<div class="iconfont icon-z-likeFill">
											<span>${videos[i].dianzan}</span>
										</div>
										<div class="iconfont icon-star">
											<span>${videos[i].shoucang}</span>
										</div>
										<div class="iconfont icon-zhibo-">
											<span>${videos[i].guankan}</span>
										</div>
									</div>
								</div>`;
					}
					$(".sets>div").html(homes);
//点击播放当前视频
					$(".sets").on("click",".videos",function(){
						console.log($(this).index());
						var ids=$(this).data("ids");
						console.log(ids);
					})
				},error: function(error) {
		            console.log(error);         
		        }
			});*/
		},function(err){
			console.log(err);
		})
//上传视频
		$("#upvideo").click(function(){
			window.location.href="releases.html";
		})
	})
</script>
	</body>
</html>
